-- EXO HUB | Fly + NoClip
-- discord.gg/6QzV9pTWs

local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local UIS = game:GetService("UserInputService")
local TweenService = game:GetService("TweenService")
local player = Players.LocalPlayer

-- // STATE
local nowe = false
local tpwalking = false
local speeds = 1
local noclipEnabled = false
local noclipConn = nil

-- // FLY LOGIC (from your script)
local function startTpWalking()
    tpwalking = false
    for i = 1, speeds do
        spawn(function()
            local hb = RunService.Heartbeat
            tpwalking = true
            local chr = player.Character
            local hum = chr and chr:FindFirstChildWhichIsA("Humanoid")
            while tpwalking and hb:Wait() and chr and hum and hum.Parent do
                if hum.MoveDirection.Magnitude > 0 then
                    chr:TranslateBy(hum.MoveDirection)
                end
            end
        end)
    end
end

local function disableStates(hum)
    for _, s in pairs(Enum.HumanoidStateType:GetEnumItems()) do
        pcall(function() hum:SetStateEnabled(s, false) end)
    end
    hum:ChangeState(Enum.HumanoidStateType.Swimming)
end

local function enableStates(hum)
    for _, s in pairs(Enum.HumanoidStateType:GetEnumItems()) do
        pcall(function() hum:SetStateEnabled(s, true) end)
    end
    hum:ChangeState(Enum.HumanoidStateType.RunningNoPhysics)
end

local function startFly()
    local char = player.Character
    if not char then return end
    local hum = char:FindFirstChildWhichIsA("Humanoid")
    if not hum then return end
    local isR6 = hum.RigType == Enum.HumanoidRigType.R6
    local torso = isR6 and char:FindFirstChild("Torso") or char:FindFirstChild("UpperTorso")
    if not torso then return end

    char.Animate.Disabled = true
    for _, t in pairs(hum:GetPlayingAnimationTracks()) do t:AdjustSpeed(0) end
    disableStates(hum)
    startTpWalking()
    hum.PlatformStand = true

    local bg = Instance.new("BodyGyro", torso)
    bg.P = 9e4
    bg.maxTorque = Vector3.new(9e9, 9e9, 9e9)
    bg.cframe = torso.CFrame

    local bv = Instance.new("BodyVelocity", torso)
    bv.velocity = Vector3.new(0, 0.1, 0)
    bv.maxForce = Vector3.new(9e9, 9e9, 9e9)

    local ctrl = {f=0,b=0,l=0,r=0}
    local lastctrl = {f=0,b=0,l=0,r=0}
    local maxspeed = 50
    local spd = 0
    local conn

    conn = RunService.RenderStepped:Connect(function()
        if not nowe then
            conn:Disconnect()
            bg:Destroy()
            bv:Destroy()
            hum.PlatformStand = false
            char.Animate.Disabled = false
            tpwalking = false
            enableStates(hum)
            return
        end
        ctrl.f = UIS:IsKeyDown(Enum.KeyCode.W) and 1 or 0
        ctrl.b = UIS:IsKeyDown(Enum.KeyCode.S) and -1 or 0
        ctrl.l = UIS:IsKeyDown(Enum.KeyCode.A) and -1 or 0
        ctrl.r = UIS:IsKeyDown(Enum.KeyCode.D) and 1 or 0
        if ctrl.l+ctrl.r ~= 0 or ctrl.f+ctrl.b ~= 0 then
            spd = math.min(spd+0.5+(spd/maxspeed), maxspeed)
        else
            spd = math.max(spd-1, 0)
        end
        local cam = workspace.CurrentCamera.CoordinateFrame
        if (ctrl.l+ctrl.r) ~= 0 or (ctrl.f+ctrl.b) ~= 0 then
            bv.velocity = ((cam.lookVector*(ctrl.f+ctrl.b))+((cam*CFrame.new(ctrl.l+ctrl.r,(ctrl.f+ctrl.b)*.2,0).p)-cam.p))*spd
            lastctrl = {f=ctrl.f,b=ctrl.b,l=ctrl.l,r=ctrl.r}
        elseif spd ~= 0 then
            bv.velocity = ((cam.lookVector*(lastctrl.f+lastctrl.b))+((cam*CFrame.new(lastctrl.l+lastctrl.r,(lastctrl.f+lastctrl.b)*.2,0).p)-cam.p))*spd
        else
            bv.velocity = Vector3.new(0, 0, 0)
        end
        bg.cframe = cam * CFrame.Angles(-math.rad((ctrl.f+ctrl.b)*50*spd/maxspeed), 0, 0)
    end)
end

-- // NOCLIP LOGIC
local function startNoclip()
    noclipConn = RunService.Stepped:Connect(function()
        local char = player.Character
        if not char then return end
        for _, p in ipairs(char:GetDescendants()) do
            if p:IsA("BasePart") then p.CanCollide = false end
        end
    end)
end

local function stopNoclip()
    if noclipConn then noclipConn:Disconnect() noclipConn = nil end
    local char = player.Character
    if char then
        for _, p in ipairs(char:GetDescendants()) do
            if p:IsA("BasePart") then p.CanCollide = true end
        end
    end
end

-- // GUI
if player.PlayerGui:FindFirstChild("ExoFlyUI") then
    player.PlayerGui.ExoFlyUI:Destroy()
end

local gui = Instance.new("ScreenGui")
gui.Name = "ExoFlyUI"
gui.ResetOnSpawn = false
gui.DisplayOrder = 999
gui.IgnoreGuiInset = true
gui.Parent = player.PlayerGui

local frame = Instance.new("Frame", gui)
frame.Size = UDim2.new(0, 210, 0, 200)
frame.Position = UDim2.new(0, 16, 0.5, -100)
frame.BackgroundColor3 = Color3.fromRGB(8, 6, 16)
frame.BorderSizePixel = 0
frame.Active = true
Instance.new("UICorner", frame).CornerRadius = UDim.new(0, 14)

local outerStroke = Instance.new("UIStroke", frame)
outerStroke.Color = Color3.fromRGB(110, 70, 255)
outerStroke.Thickness = 1.5
outerStroke.Transparency = 0.3

-- // TITLE BAR
local titleBar = Instance.new("Frame", frame)
titleBar.Size = UDim2.new(1, 0, 0, 38)
titleBar.BackgroundColor3 = Color3.fromRGB(14, 10, 28)
titleBar.BorderSizePixel = 0
Instance.new("UICorner", titleBar).CornerRadius = UDim.new(0, 14)
-- fix bottom corners
local tbFix = Instance.new("Frame", titleBar)
tbFix.Size = UDim2.new(1, 0, 0.5, 0)
tbFix.Position = UDim2.new(0, 0, 0.5, 0)
tbFix.BackgroundColor3 = Color3.fromRGB(14, 10, 28)
tbFix.BorderSizePixel = 0

-- shimmer accent line
local shimmer = Instance.new("Frame", titleBar)
shimmer.Size = UDim2.new(1, 0, 0, 2)
shimmer.Position = UDim2.new(0, 0, 1, -2)
shimmer.BackgroundColor3 = Color3.fromRGB(130, 80, 255)
shimmer.BorderSizePixel = 0
local shimGrad = Instance.new("UIGradient", shimmer)
shimGrad.Color = ColorSequence.new({
    ColorSequenceKeypoint.new(0,   Color3.fromRGB(0,0,0)),
    ColorSequenceKeypoint.new(0.35, Color3.fromRGB(110,60,255)),
    ColorSequenceKeypoint.new(0.65, Color3.fromRGB(180,130,255)),
    ColorSequenceKeypoint.new(1,   Color3.fromRGB(0,0,0)),
})
task.spawn(function()
    local t = 0
    while gui.Parent do
        t += 0.025
        shimGrad.Offset = Vector2.new(math.sin(t) * 0.8, 0)
        task.wait(0.03)
    end
end)

-- title text
local titleLbl = Instance.new("TextLabel", titleBar)
titleLbl.Size = UDim2.new(1, -42, 1, 0)
titleLbl.Position = UDim2.new(0, 12, 0, 0)
titleLbl.BackgroundTransparency = 1
titleLbl.Text = "EXO HUB"
titleLbl.Font = Enum.Font.GothamBlack
titleLbl.TextSize = 15
titleLbl.TextXAlignment = Enum.TextXAlignment.Left
local titleGrad = Instance.new("UIGradient", titleLbl)
titleGrad.Color = ColorSequence.new({
    ColorSequenceKeypoint.new(0,   Color3.fromRGB(140, 90, 255)),
    ColorSequenceKeypoint.new(0.5, Color3.fromRGB(220, 200, 255)),
    ColorSequenceKeypoint.new(1,   Color3.fromRGB(110, 60, 240)),
})
titleGrad.Rotation = 90

-- close btn
local closeBtn = Instance.new("TextButton", titleBar)
closeBtn.Size = UDim2.new(0, 22, 0, 22)
closeBtn.Position = UDim2.new(1, -30, 0.5, -11)
closeBtn.BackgroundColor3 = Color3.fromRGB(180, 40, 60)
closeBtn.Text = "âœ•"
closeBtn.TextColor3 = Color3.fromRGB(255,255,255)
closeBtn.Font = Enum.Font.GothamBold
closeBtn.TextSize = 10
closeBtn.BorderSizePixel = 0
Instance.new("UICorner", closeBtn).CornerRadius = UDim.new(0, 6)
closeBtn.MouseButton1Click:Connect(function()
    nowe = false
    noclipEnabled = false
    stopNoclip()
    gui:Destroy()
end)

-- // DRAGGING from title bar
local dragging, dragStart, startPos = false, nil, nil
titleBar.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = true
        dragStart = input.Position
        startPos = frame.Position
        input.Changed:Connect(function()
            if input.UserInputState == Enum.UserInputState.End then dragging = false end
        end)
    end
end)
UIS.InputChanged:Connect(function(input)
    if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
        local delta = input.Position - dragStart
        frame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)

-- // TOGGLE MAKER
local function makeToggle(labelText, yPos, onToggle)
    local row = Instance.new("Frame", frame)
    row.Size = UDim2.new(1, -20, 0, 38)
    row.Position = UDim2.new(0, 10, 0, yPos)
    row.BackgroundColor3 = Color3.fromRGB(14, 10, 28)
    row.BorderSizePixel = 0
    Instance.new("UICorner", row).CornerRadius = UDim.new(0, 10)
    local rs = Instance.new("UIStroke", row)
    rs.Color = Color3.fromRGB(70, 40, 160)
    rs.Thickness = 1

    local lbl = Instance.new("TextLabel", row)
    lbl.Size = UDim2.new(1, -52, 1, 0)
    lbl.Position = UDim2.new(0, 12, 0, 0)
    lbl.BackgroundTransparency = 1
    lbl.Text = labelText
    lbl.Font = Enum.Font.GothamBold
    lbl.TextSize = 13
    lbl.TextColor3 = Color3.fromRGB(170, 145, 230)
    lbl.TextXAlignment = Enum.TextXAlignment.Left

    local sw = Instance.new("Frame", row)
    sw.Size = UDim2.new(0, 36, 0, 20)
    sw.AnchorPoint = Vector2.new(1, 0.5)
    sw.Position = UDim2.new(1, -10, 0.5, 0)
    sw.BackgroundColor3 = Color3.fromRGB(30, 18, 55)
    sw.BorderSizePixel = 0
    Instance.new("UICorner", sw).CornerRadius = UDim.new(1, 0)

    local ball = Instance.new("Frame", sw)
    ball.Size = UDim2.new(0, 14, 0, 14)
    ball.AnchorPoint = Vector2.new(0.5, 0.5)
    ball.Position = UDim2.new(0.27, 0, 0.5, 0)
    ball.BackgroundColor3 = Color3.fromRGB(200, 180, 255)
    ball.BorderSizePixel = 0
    Instance.new("UICorner", ball).CornerRadius = UDim.new(1, 0)

    local state = false
    local clickArea = Instance.new("TextButton", row)
    clickArea.Size = UDim2.new(1, 0, 1, 0)
    clickArea.BackgroundTransparency = 1
    clickArea.Text = ""

    local ti = TweenInfo.new(0.18, Enum.EasingStyle.Quart)
    clickArea.MouseButton1Click:Connect(function()
        state = not state
        TweenService:Create(sw, ti, {BackgroundColor3 = state and Color3.fromRGB(110, 60, 255) or Color3.fromRGB(30, 18, 55)}):Play()
        TweenService:Create(ball, ti, {Position = state and UDim2.new(0.75,0,0.5,0) or UDim2.new(0.27,0,0.5,0)}):Play()
        TweenService:Create(rs, ti, {Color = state and Color3.fromRGB(130, 80, 255) or Color3.fromRGB(70, 40, 160)}):Play()
        onToggle(state)
    end)

    return row
end

-- // SPEED ROW
local speedRow = Instance.new("Frame", frame)
speedRow.Size = UDim2.new(1, -20, 0, 34)
speedRow.Position = UDim2.new(0, 10, 0, 48)
speedRow.BackgroundColor3 = Color3.fromRGB(14, 10, 28)
speedRow.BorderSizePixel = 0
Instance.new("UICorner", speedRow).CornerRadius = UDim.new(0, 10)
Instance.new("UIStroke", speedRow).Color = Color3.fromRGB(70, 40, 160)

local speedLbl = Instance.new("TextLabel", speedRow)
speedLbl.Size = UDim2.new(0.5, 0, 1, 0)
speedLbl.Position = UDim2.new(0, 12, 0, 0)
speedLbl.BackgroundTransparency = 1
speedLbl.Text = "SPEED  Â· " .. speeds
speedLbl.Font = Enum.Font.GothamBold
speedLbl.TextSize = 12
speedLbl.TextColor3 = Color3.fromRGB(150, 110, 220)
speedLbl.TextXAlignment = Enum.TextXAlignment.Left

local minusBtn = Instance.new("TextButton", speedRow)
minusBtn.Size = UDim2.new(0, 26, 0, 22)
minusBtn.AnchorPoint = Vector2.new(1, 0.5)
minusBtn.Position = UDim2.new(1, -34, 0.5, 0)
minusBtn.BackgroundColor3 = Color3.fromRGB(25, 14, 50)
minusBtn.Text = "âˆ’"
minusBtn.TextColor3 = Color3.fromRGB(160, 120, 255)
minusBtn.Font = Enum.Font.GothamBold
minusBtn.TextSize = 15
minusBtn.BorderSizePixel = 0
Instance.new("UICorner", minusBtn).CornerRadius = UDim.new(0, 6)

local plusBtn = Instance.new("TextButton", speedRow)
plusBtn.Size = UDim2.new(0, 26, 0, 22)
plusBtn.AnchorPoint = Vector2.new(1, 0.5)
plusBtn.Position = UDim2.new(1, -4, 0.5, 0)
plusBtn.BackgroundColor3 = Color3.fromRGB(25, 14, 50)
plusBtn.Text = "+"
plusBtn.TextColor3 = Color3.fromRGB(160, 120, 255)
plusBtn.Font = Enum.Font.GothamBold
plusBtn.TextSize = 15
plusBtn.BorderSizePixel = 0
Instance.new("UICorner", plusBtn).CornerRadius = UDim.new(0, 6)

minusBtn.MouseButton1Click:Connect(function()
    if speeds > 1 then
        speeds -= 1
        speedLbl.Text = "SPEED  Â· " .. speeds
        if nowe then tpwalking = false; startTpWalking() end
    end
end)
plusBtn.MouseButton1Click:Connect(function()
    speeds += 1
    speedLbl.Text = "SPEED  Â· " .. speeds
    if nowe then tpwalking = false; startTpWalking() end
end)

-- // UP / DOWN ROW
local udRow = Instance.new("Frame", frame)
udRow.Size = UDim2.new(1, -20, 0, 34)
udRow.Position = UDim2.new(0, 10, 0, 88)
udRow.BackgroundColor3 = Color3.fromRGB(14, 10, 28)
udRow.BorderSizePixel = 0
Instance.new("UICorner", udRow).CornerRadius = UDim.new(0, 10)
Instance.new("UIStroke", udRow).Color = Color3.fromRGB(70, 40, 160)

local udLabel = Instance.new("TextLabel", udRow)
udLabel.Size = UDim2.new(0.4, 0, 1, 0)
udLabel.Position = UDim2.new(0, 12, 0, 0)
udLabel.BackgroundTransparency = 1
udLabel.Text = "VERTICAL"
udLabel.Font = Enum.Font.GothamBold
udLabel.TextSize = 11
udLabel.TextColor3 = Color3.fromRGB(130, 95, 200)
udLabel.TextXAlignment = Enum.TextXAlignment.Left

local upBtn = Instance.new("TextButton", udRow)
upBtn.Size = UDim2.new(0, 50, 0, 22)
upBtn.AnchorPoint = Vector2.new(1, 0.5)
upBtn.Position = UDim2.new(1, -60, 0.5, 0)
upBtn.BackgroundColor3 = Color3.fromRGB(25, 14, 50)
upBtn.Text = "â–² UP"
upBtn.TextColor3 = Color3.fromRGB(160, 120, 255)
upBtn.Font = Enum.Font.GothamBold
upBtn.TextSize = 11
upBtn.BorderSizePixel = 0
Instance.new("UICorner", upBtn).CornerRadius = UDim.new(0, 6)

local downBtn = Instance.new("TextButton", udRow)
downBtn.Size = UDim2.new(0, 50, 0, 22)
downBtn.AnchorPoint = Vector2.new(1, 0.5)
downBtn.Position = UDim2.new(1, -4, 0.5, 0)
downBtn.BackgroundColor3 = Color3.fromRGB(25, 14, 50)
downBtn.Text = "â–¼ DN"
downBtn.TextColor3 = Color3.fromRGB(160, 120, 255)
downBtn.Font = Enum.Font.GothamBold
downBtn.TextSize = 11
downBtn.BorderSizePixel = 0
Instance.new("UICorner", downBtn).CornerRadius = UDim.new(0, 6)

local upHeld, downHeld = false, false
upBtn.MouseButton1Down:Connect(function() upHeld = true
    while upHeld do
        local hrp = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
        if hrp then hrp.CFrame *= CFrame.new(0,1,0) end
        task.wait()
    end
end)
upBtn.MouseButton1Up:Connect(function() upHeld = false end)
upBtn.MouseLeave:Connect(function() upHeld = false end)
downBtn.MouseButton1Down:Connect(function() downHeld = true
    while downHeld do
        local hrp = player.Character and player.Character:FindFirstChild("HumanoidRootPart")
        if hrp then hrp.CFrame *= CFrame.new(0,-1,0) end
        task.wait()
    end
end)
downBtn.MouseButton1Up:Connect(function() downHeld = false end)
downBtn.MouseLeave:Connect(function() downHeld = false end)

-- // FLY TOGGLE
makeToggle("âœˆ  Fly", 130, function(state)
    nowe = state
    if state then startFly() end
end)

-- // NOCLIP TOGGLE
makeToggle("ðŸ‘»  NoClip", 175, function(state)
    noclipEnabled = state
    if state then startNoclip() else stopNoclip() end
end)

-- // PULSE on stroke
local t = 0
RunService.Heartbeat:Connect(function(dt)
    t += dt
    local pulse = (math.sin(t * 3) + 1) / 2
    outerStroke.Transparency = nowe and 0.05 * pulse or 0.3 + pulse * 0.25
end)

-- // RESPAWN HANDLER
player.CharacterAdded:Connect(function(char)
    task.wait(0.7)
    nowe = false
    tpwalking = false
    noclipEnabled = false
    stopNoclip()
    local hum = char:FindFirstChildWhichIsA("Humanoid")
    if hum then hum.PlatformStand = false end
    if char:FindFirstChild("Animate") then char.Animate.Disabled = false end
end)

-- // OPEN ANIM
frame.Position = UDim2.new(-0.4, 0, 0.5, -100)
TweenService:Create(frame, TweenInfo.new(0.35, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {
    Position = UDim2.new(0, 16, 0.5, -100)
}):Play()

print("[EXO HUB] Fly + NoClip Loaded | discord.gg/6QzV9pTWs")
